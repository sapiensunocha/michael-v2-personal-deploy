import { readFileSync } from "fs"; import * as XLSX from "xlsx"; const buffer = readFileSync("/Users/sapiensndatabaye/Desktop/APPS/michael_v2.0.1-main/public/data/Datasets.xlsx"); const workbook = XLSX.read(buffer, { type: "buffer" }); const sheet = workbook.Sheets["SUM-SHEET"]; if (!sheet) { console.error("SUM-SHEET not found"); process.exit(1); } const data = XLSX.utils.sheet_to_json(sheet, { header: 1 }); const events = data.slice(1).map(row => ({ id: row[0]?.toString() || "unknown", longitude: parseFloat(row[1]) || 0, latitude: parseFloat(row[2]) || 0, disaster_type: row[3]?.toString() || "Unknown", depth: parseFloat(row[4]) || 0, magnitude: parseFloat(row[5]) || 0, time: typeof row[7] === "number" ? row[7] * 86400000 : new Date(row[7]).getTime() || Date.now(), place: row[3] ? row[3].charAt(0).toUpperCase() + row[3].slice(1) + " Event" : "Unknown Event" })).filter(e => !isNaN(e.latitude) && !isNaN(e.longitude) && e.disaster_type); events.sort((a, b) => b.magnitude - a.magnitude); console.log("Top 10 Earthquakes by Magnitude:", events.slice(0, 10).map(e => ({ id: e.id, place: e.place, magnitude: e.magnitude, time: new Date(e.time).toLocaleString() })));
